# 0x07_反射

## java.lang.Class

- getFields: 返回public成员, 包含超类的public成员
- getMethods
- getConstructors: 返回构造器数组
- getDeclareFields: 返回全部成员(包含private, protected), 不包含超类成员
- getDeclareMethods
- getDeclareConstructors

## java.lang.reflect

- getName
- getModifiers: 通过不同的位开关描述public, static等修饰符

### Field

getType: 返回成员所属Class对象

### Method

### Constructor

### Modifier

静态方法分析getModifiers()返回的修饰符:

- isPublic
- isPrivate
- isFinal
- toString: 打印修饰符

```java
public class ReflectDemo {
    public static void main(String[] args)
            throws ClassNotFoundException, IllegalAccessException, InstantiationException {
        ReflectDemo reflect = new ReflectDemo();
        // 1. 通过Object类中的getClass方法, 获取java.lang.Class类的实例, 保存该类的所有信息
        Class cls = reflect.getClass();
        // xxx.ReflectDemo
        System.out.println("Object.getClass(): " + cls.getName());

        // 2. 通过class属性获取Class对象
        Class cls1 = ReflectDemo.class;
        // libdemo.ReflectDemo
        System.out.println("Xxx.class: " + cls1.getName());
        Class cls2 = int.class;
        // int
        System.out.println(cls2.getName());
        Class cls3 = Double.class;
        // java.lang.Double
        System.out.println(cls3.getName());
        Class cls4 = int[].class;
        // [I
        System.out.println(cls4.getName());

        // 3. 通过静态方法forName()获取Class对象
        String clsName = "java.util.Random";
        Class staticClass = Class.forName(clsName);
        // java.util.Random
        System.out.println("Class.forName(): " + staticClass.getName());

        // 比较两个类是否相同
        // true
        System.out.println("==: " + (cls == cls1));

        // 获取超类
        Class superCls = staticClass.getSuperclass();
        if (superCls != Object.class) {
            System.out.println("Class.getSuperclass(): " + superCls.getName());
        }

        // 获取修饰符
        int mod = staticClass.getModifiers();
        // 解析修饰符 public
        System.out.println("Class.getModifiers(): " + Modifier.toString(mod));

        // 获取构造函数数组
        Constructor[] constructors = staticClass.getDeclaredConstructors();
        System.out.println("Constructors:");
        for (Constructor c : constructors) {
            System.out.print(Modifier.toString(c.getModifiers()) + " ");
            System.out.print(c.getName() + " ");

            // 构造函数参数列表类型
            Class[] paramTypes = c.getParameterTypes();
            for (Class pt : paramTypes) {
                System.out.print(pt.getName() + " ");
            }
            System.out.println();
        }

        // 获取所有方法
        Method[] methods = staticClass.getDeclaredMethods();
        System.out.println("Methods:");
        for (Method m : methods) {
            System.out.print(Modifier.toString(m.getModifiers()) + " ");
            // 方法返回类型
            Class returnType = m.getReturnType();
            System.out.print(returnType.getName() + " ");
            System.out.print(m.getName() + " ");
            // 参数列表类型
            Class[] paramTypes = m.getParameterTypes();
            for (Class pt : paramTypes) {
                System.out.print(pt.getName() + " ");
            }
            System.out.println();
        }

        Field[] fields = staticClass.getDeclaredFields();
        System.out.println("Fields:");
        for (Field f : fields) {
            System.out.print(Modifier.toString(f.getModifiers()) + " ");
            // 成员类型
            Class type = f.getType();
            System.out.print(type.getName() + " ");
            System.out.print(f.getName() + " ");
            System.out.println();
        }

        // 动态创建实例, 调用无参构造函数
        Object obj = staticClass.newInstance();
    }
}
```

!!! quote "参考文献: Java核心技术 卷1 基础知识 原书第10版 - 5.7 反射"
