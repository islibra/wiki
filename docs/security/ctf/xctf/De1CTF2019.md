# De1CTF2019

## ShellShellShell

利用`dirsearch`扫描服务器还有哪些文件, 发现存在

```
$ cat 19-08-17_16-45-47 | grep 200
200    16KB  http://127.0.0.1:11027/.config.php.swp
200     0B   http://127.0.0.1:11027/config.php
200    83KB  http://127.0.0.1:11027/phpinfo.php
200   934B   http://127.0.0.1:11027/upload/
200     0B   http://127.0.0.1:11027/upload/test.txt
200     0B   http://127.0.0.1:11027/user.php
```

尝试把`.index.php.swp`, `.config.php.swp`, `.user.php.swp`下载下来

使用`vim -r index.php`查看源码

在`index.php`中发现require `user.php`, 还会require `views`目录中的 `delete|index|login|logout|phpinfo|profile|publish|register`, 通过GET参数中的action控制页面跳转

在`user.php`中发现需要下载`user.php.bak`, `user.php`中require `config.php`

使用`register`注册, 破解md5, 使用`login`登录, 到`index`. `profile`设置是否允许不同ip登录, `publish`允许输入两个参数`signature`和`mood`, 在`index`页面显示, `delete`删除, `logout`退出

`publish`调用`insert`往数据库中插入数据, SQL语句拼接, 且`signature`可控

`$columns`改成`` `userid`,`username`,`signature`,`mood` ``, `$value`改成`(...)`, 并且一对反引号中的内容如果不存在反引号+逗号, 就把反引号改为单引号

md5解密为`jaivypassword`

但是使用admin登录返回`You can only login at the usual address`




https://www.xctf.org.cn/library/details/79378efa88bff52451b2f822abe562d29ae7aade/

https://github.com/De1ta-team/De1CTF2019/blob/master/writeup/web/ShellShellShell/README_zh.md

https://github.com/De1ta-team/De1CTF2019/tree/master/writeup/web/ShellShellShell/dockerfile

[Docker教程：Docker Compose入门](https://mp.weixin.qq.com/s?src=11&timestamp=1565858991&ver=1791&signature=hIX-hA2DxsOWzLHCIU*ONH0q*E4MWL0i*qmhQnBIqlmpZh6KD9ehk8XcyEuhmnnYbNa2g8jNrYwm44C5zZchM*Nb*lV1buaXryI1huMoEZuY88CG8usGQF55mPb6TDGl&new=1)
